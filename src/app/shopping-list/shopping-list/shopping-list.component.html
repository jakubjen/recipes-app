<h3 class="fs-5 fw-bold">
	{{ 'Recipes.Ingredients' | translate }}
</h3>
<form
	[formGroup]="ingredientForm"
	#ngForm="ngForm"
	(ngSubmit)="submit(); ngForm.resetForm()">
	<div class="row mt-3">
		<div class="col-6 col-lg-3 amount">
			<input
				type="number"
				class="form-control"
				formControlName="amount"
				[class.is-invalid]="
					(amount.touched || ngForm.submitted) && !!amount.errors
				"
				placeholder="Amount" />
			<app-form-error [input]="amount" [form]="ngForm"></app-form-error>
		</div>

		<div class="col-6 col-lg-3">
			<select
				class="form-select"
				aria-label="select unit"
				formControlName="unit"
				formControlName="unit">
				<option *ngFor="let unit of units.weight | keyvalue" [value]="unit.key">
					{{ unit.key }}
				</option>
				<option *ngFor="let unit of units.volume | keyvalue" [value]="unit.key">
					{{ unit.key }}
				</option>
				<option *ngFor="let unit of units.other" [value]="unit">
					{{ unit }}
				</option>
			</select>
			<app-form-error
				[input]="ingredientForm.controls.unit"
				[form]="ngForm"></app-form-error>
		</div>

		<div class="col-12 col-lg-6 mt-3 mt-lg-0">
			<div class="input-group">
				<input
					type="text"
					class="form-control"
					placeholder="Name"
					[class.is-invalid]="
						(name.touched || ngForm.submitted) && !!name.errors
					"
					formControlName="name" />
				<button
					type="button"
					class="btn btn-danger"
					aria-label="Reset"
					(click)="ngForm.reset(); mode = 'add'">
					<i class="bi bi-x-lg"></i>
				</button>
			</div>
			<app-form-error [input]="name" [form]="ngForm"></app-form-error>
		</div>
	</div>
	<button type="submit" class="btn btn-outline-primary mt-3">
		{{ submitButtonText | translate }}
	</button>
</form>

<div class="col-12">
	<table class="table mt-3">
		<thead>
			<tr>
				<th scope="col">#</th>
				<th scope="col">Amount</th>
				<th scope="col">Name</th>
			</tr>
		</thead>
		<tbody>
			<ng-container *ngIf="ingredientList$ | async as ingredientList">
				<tr *ngFor="let ingredient of ingredientList; let i = index">
					<th scope="row">{{ i + 1 }}</th>
					<td>{{ ingredient.amount }} {{ ingredient.unit }}</td>
					<td>
						<div class="col-name">
							<div class="text">
								{{ ingredient.name }}
							</div>

							<div class="buttons">
								<span
									type="button"
									class="text-primary"
									(click)="editIngredient(ingredient)">
									<i class="bi bi-pencil"></i>
								</span>
								<span
									type="button"
									class="text-danger"
									(click)="removeIngredient(ingredient.id)">
									<i class="bi bi-x-circle"></i>
								</span>
							</div>
						</div>
					</td>
				</tr>
			</ng-container>
		</tbody>
	</table>
</div>
